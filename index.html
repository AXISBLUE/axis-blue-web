<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AXIS BLUE • Field Ops</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <div class="bg"></div>

  <header class="top">
    <div class="brand">
      <div class="brand-mark">AXIS</div>
      <div class="brand-text">
        <div class="h1">AXIS BLUE</div>
        <div class="h2">Field Operations • Test</div>
        <div class="sub">aptest.axisblue.io</div>
      </div>
    </div>

    <div class="badges">
      <span class="pill">Environment: Test</span>
      <span class="pill">Data: Supabase</span>
      <span class="pill">Build: Pages + Functions</span>
    </div>
  </header>

  <main class="wrap">
    <!-- AUTH (always visible) -->
    <section class="card" id="authCard">
      <div class="cardHead">
        <div class="cardTitle">Authentication</div>
        <div class="cardMeta" id="authMeta">Signed out</div>
      </div>

      <div class="grid2">
        <div class="field">
          <label>Email</label>
          <input id="authEmail" type="email" placeholder="you@domain.com" autocomplete="username" />
        </div>
        <div class="field">
          <label>Password</label>
          <input id="authPassword" type="password" placeholder="••••••••" autocomplete="current-password" />
        </div>
      </div>

      <div class="row">
        <button class="btn primary" id="btnSignIn">Sign in</button>
        <button class="btn" id="btnSignOut">Sign out</button>
        <span class="msg" id="authMsg"></span>
      </div>
    </section>

    <!-- LOCKED APP (hidden until auth) -->
    <section class="card locked" id="appCard" aria-hidden="true">
      <div class="cardHead">
        <div class="cardTitle">Run Day</div>
        <div class="cardMeta" id="appMeta">Locked until sign-in succeeds.</div>
      </div>

      <nav class="tabs">
        <button class="tab active" data-tab="tabDay">Day</button>
        <button class="tab" data-tab="tabVisit">Visit</button>
        <button class="tab" data-tab="tabCapture">Capture</button>
        <button class="tab" data-tab="tabMgmt">Management</button>
      </nav>

      <!-- DAY -->
      <div class="tabPane active" id="tabDay">
        <div class="sectionTitle">Start Day</div>
        <div class="grid2">
          <div class="field">
            <label>Merchandiser name</label>
            <input id="dayMerchName" type="text" placeholder="Gabriel Kearns" />
          </div>
          <div class="field">
            <label>Date</label>
            <input id="dayDate" type="date" />
          </div>
        </div>
        <div class="row">
          <button class="btn primary" id="btnBeginDay">Begin Day</button>
          <button class="btn" id="btnLoadDay">Load Active Day</button>
          <span class="msg" id="dayMsg"></span>
        </div>
        <div class="kv">
          <div><span>Active Day ID:</span> <code id="activeDayId">None</code></div>
        </div>
      </div>

      <!-- VISIT -->
      <div class="tabPane" id="tabVisit">
        <div class="sectionTitle">Visit</div>

        <div class="grid2">
          <div class="field">
            <label>Store</label>
            <select id="visitStore">
              <option value="">Select…</option>
              <option value="WM1492|Walmart 1492|14000 E Exposition Ave Aurora CO 80012">Walmart 1492</option>
              <option value="KS00014|King Soopers 00014|655 Peoria St Aurora CO 80011">King Soopers 00014</option>
              <option value="FD3477|Family Dollar 3477|620 Peoria St Aurora CO 80011">Family Dollar 3477</option>
              <option value="TGT1471|Target SC 1471|14200 E Ellsworth Ave Aurora CO 80012">Target SC 1471</option>
            </select>
          </div>
          <div class="field">
            <label>Visit note</label>
            <input id="visitNote" type="text" placeholder="Delivery, reset, follow-up… (optional)" />
          </div>
        </div>

        <div class="row">
          <button class="btn primary" id="btnStartVisit">Start Visit</button>
          <button class="btn danger" id="btnEndVisit">End Visit</button>
          <span class="msg" id="visitMsg"></span>
        </div>

        <div class="kv">
          <div><span>Active Visit ID:</span> <code id="activeVisitId">None</code></div>
          <div><span>Status:</span> <span id="visitStatus">No active visit</span></div>
        </div>

        <hr class="sep" />

        <div class="sectionTitle">Out-of-Stock / Breakage / OOD</div>
        <div class="grid2">
          <div class="field">
            <label>Issue type</label>
            <select id="oosType">
              <option value="OOS">Out of Stock</option>
              <option value="BREAKAGE">Breakage</option>
              <option value="OOD">Out of Date</option>
            </select>
          </div>
          <div class="field">
            <label>Item (scan or type)</label>
            <input id="oosItem" type="text" placeholder="UPC / QR payload / SKU / description" />
          </div>
        </div>
        <div class="grid2">
          <div class="field">
            <label>Qty</label>
            <input id="oosQty" type="number" min="0" step="1" placeholder="0" />
          </div>
          <div class="field">
            <label>Notes</label>
            <input id="oosNote" type="text" placeholder="Optional" />
          </div>
        </div>
        <div class="row">
          <button class="btn primary" id="btnAddOOS">Add Issue</button>
          <span class="msg" id="oosMsg"></span>
        </div>

        <div class="list" id="oosList"></div>
      </div>

      <!-- CAPTURE -->
      <div class="tabPane" id="tabCapture">
        <div class="sectionTitle">Photo + Intelligence Capture</div>

        <div class="grid2">
          <div class="field">
            <label>Photo category</label>
            <select id="capCategory">
              <option value="Sales Floor">Sales Floor</option>
              <option value="Backroom">Backroom</option>
              <option value="Credits">Credits</option>
              <option value="Coolers">Coolers</option>
              <option value="Other">Other</option>
            </select>
          </div>
          <div class="field">
            <label>Optional label</label>
            <input id="capLabel" type="text" placeholder="Aisle 8 endcap / Cooler door 2 / credits pallet…" />
          </div>
        </div>

        <div class="scanBlock">
          <div class="scanHead">
            <div class="scanTitle">Barcode / QR Scan (auto-start when possible)</div>
            <div class="scanMeta" id="scanMeta">Ready</div>
          </div>

          <div class="row">
            <button class="btn primary" id="btnEnableCamera">Enable Camera Scan</button>
            <button class="btn" id="btnStopCamera">Stop</button>
          </div>

          <video id="scanVideo" class="video" playsinline muted></video>

          <div class="field">
            <label>Detected code</label>
            <input id="capDetected" type="text" placeholder="Auto-populates…" />
          </div>
        </div>

        <div class="scanBlock">
          <div class="scanHead">
            <div class="scanTitle">NFC (iOS fallback via Shortcut URL param)</div>
            <div class="scanMeta" id="nfcMeta">If opened as ?nfc=..., it will auto-fill.</div>
          </div>

          <div class="field">
            <label>NFC payload</label>
            <input id="capNfc" type="text" placeholder="Auto-populates when available…" />
          </div>
        </div>

        <div class="field">
          <label>Tag photo required</label>
          <input id="capFile" type="file" accept="image/*" />
        </div>

        <div class="row">
          <button class="btn primary" id="btnSaveCapture">Save Capture</button>
          <span class="msg" id="capMsg"></span>
        </div>

        <div class="list" id="capList"></div>
      </div>

      <!-- MGMT -->
      <div class="tabPane" id="tabMgmt">
        <div class="sectionTitle">Management Output</div>
        <div class="field">
          <label>Summary text</label>
          <textarea id="mgmtText" rows="6" placeholder="Quick summary for management…"></textarea>
        </div>
        <div class="row">
          <button class="btn" id="btnCopy">Copy Summary</button>
          <button class="btn primary" id="btnEmailDraft">Email Draft</button>
          <span class="msg" id="mgmtMsg"></span>
        </div>
        <div class="hint">
          Teams “send” requires a webhook/API. This panel gives copy + email draft today.
        </div>
      </div>
    </section>

    <footer class="foot">
      <span>AXIS BLUE • Private test environment</span>
      <span id="envStatus">env: loading…</span>
    </footer>
  </main>

  <script src="/supabaseClient.js"></script>
  <script src="/app.js"></script>
</body>
</html>
